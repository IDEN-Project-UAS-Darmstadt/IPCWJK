<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>IPCWJK: IPCW jackknife SE Estimation for right-censored survival data  — IPCWJK-package • IPCWJK</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="IPCWJK: IPCW jackknife SE Estimation for right-censored survival data  — IPCWJK-package"><meta name="description" content="Provides functions for fitting binary classification models with
inverse probability of censoring weights (IPCW) to estimate survival
probabilities, and implements jackknife resampling methods for unbiased
prediction error estimation."><meta property="og:description" content="Provides functions for fitting binary classification models with
inverse probability of censoring weights (IPCW) to estimate survival
probabilities, and implements jackknife resampling methods for unbiased
prediction error estimation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IPCWJK</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ipcw_models.html">IPCW Models for Survival Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/IDEN-Project-UAS-Darmstadt/IPCWJK" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>IPCWJK: IPCW jackknife SE Estimation for right-censored survival data <script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></h1>
      <small class="dont-index">Source: <a href="https://github.com/IDEN-Project-UAS-Darmstadt/IPCWJK/blob/HEAD/R/0IPCWJK-package.R" class="external-link"><code>R/0IPCWJK-package.R</code></a></small>
      <div class="d-none name"><code>IPCWJK-package.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Provides functions for fitting binary classification models with
inverse probability of censoring weights (IPCW) to estimate survival
probabilities, and implements jackknife resampling methods for unbiased
prediction error estimation.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For <em></em>\(n\) individuals we observe realizations of the random variables
of covariates, time to event and event indicators
<em></em>\((X_i,T_i,\delta_i)\). We assume the variables
are independent identically distributed between individuals. The time to
to event is right-censored. For the underlying unobserved time to event
<em></em>\(T^*_i\) and time to censoring <em></em>\(C_i\) we assume
them to be independent conditional on <em></em>\(X_i\).</p><div class="section">
<h3 id="prediction-target-and-ipcw">Prediction Target and IPCW<a class="anchor" aria-label="anchor" href="#prediction-target-and-ipcw"></a></h3>


<p>The goal is to predict the survival probability <em></em>\(p_i\) at a
time horizon <em></em>\(\tau\). This probability is defined as</p>
<p>\[
p_i:=P(T^* \geq \tau | X=x_i) = P(Y=1|X=x_i).\]</p>
<p>The random variable <em></em>\(Y:=\mathbf{I}(T^* &gt; \tau)\)
represents the dichotomized outcome that a binary classifier could use
as the dependent variable for predicting <em></em>\(p_i\).
This random variable is unobservable for individuals, who were
censored before <em></em>\(\tau\). The removal of these individuals
leads to worse discrimination and calibration of the model
(Reps et al. 2021; Kvamme and Borgan 2023)
. Inverse probability of censoring
weights (IPCW) can correct this. The calculation of these weights
is implemented in <code><a href="ipcw_weights.html">ipcw_weights()</a></code>.</p>
<p>When using a maximum-likelihood based model IPCW weights can either be
applied to the contribution to the loss of a model (IPCW-GLM) or to
to the outcome of an individual (<em></em>\(Y_i\), OIPCW). In our setting,
these are equivalent (Blanche et al. 2023)
. For many
model algorithms, this distinction depends on how training weights are
implemented.</p>
<p>In this package the names of the observations of the random variables
<em></em>\((T_i,\delta_i)\) are given in the arguments <code>time_var</code>
and <code>status_var</code>. <em></em>\(\tau\) is specified with <code>tau</code>.</p>
</div>

<div class="section">
<h3 id="standard-error-se-using-the-delta-method">Standard Error (SE) using the Delta method<a class="anchor" aria-label="anchor" href="#standard-error-se-using-the-delta-method"></a></h3>


<p>For many applications uncertainty of predictions plays a large role.
Uncertainty is communicated with standard errors (SEs) or a confidence
interval of the prediction. When a differentiable function is used to
calculate predictions from asymptotically normal distributed random
variables, the delta method can be used to calculate a standard error. We
provide this functionality implemented for trained models in
<code><a href="deltamethod_from_model.html">deltamethod_from_model()</a></code>. A more flexible interface is available with
<code><a href="deltamethod_pred_function.html">deltamethod_pred_function()</a></code>.</p>
<p>The function <code><a href="deltamethod_from_model.html">deltamethod_from_model()</a></code> for example supports the
implementation of the IPCW-GLM logistic regression in <code><a href="https://kkholst.github.io/mets/reference/binreg.html" class="external-link">mets::logitIPCW()</a></code>.
From the fitted model, both the naive and for randomness of the weights
adjusted variance estimators can be used
(Blanche et al. 2023; Holst et al. 2016; Scheike et al. 2014)
.</p>
<p>This correction of the variance estimator has only been described for GLMs,
we provide a model-agnostic estimation using a weighted jackknife approach.</p>
</div>

<div class="section">
<h3 id="confidence-intervals-cis-">Confidence intervals (CIs)<a class="anchor" aria-label="anchor" href="#confidence-intervals-cis-"></a></h3>


<p>Wald confidence intervals (CIs) <em></em>\(\hat{p}\pm z_{1-\alpha/2}SE(\hat{p})
\) in their commonly used form can lead to CIs
outside the 0,1 range. Better interpretable CIs are provided
by the delta method with intervals calculated on the
logit scale. This assumes asymptotic normality of the prediction
(Perme and Manevski 2019)
.</p>
<p>\[
\Big[\frac{\exp(LL_{logit})}{1+\exp(LL_{logit})};
\frac{\exp(UL_{logit})}{1+\exp(UL_{logit})}\Big]
\]</p>
<p>\[
LL_{logit} / UL_{logit}= \ln(\frac{\hat{p}}{1-\hat{p}})
\pm z_{1-\alpha/2} \frac{SE(\hat{p})}{\hat{p}(1-\hat{p})}
\]</p>
<p>This approach is used for all CIs returned by this package.</p>
</div>

<div class="section">
<h3 id="standard-error-using-a-weighted-jackknife-estimator">Standard Error using a weighted jackknife Estimator<a class="anchor" aria-label="anchor" href="#standard-error-using-a-weighted-jackknife-estimator"></a></h3>


<p>For the jackknife (Efron and Hastie 2016)
 estimate of the prediction
standard error <em></em>\(n\)
models are trained on the training data. For the <em></em>\(i\)th model
the <em></em>\(i\)th individual gets removed from the data. The prediction
of the model trained on the full data will be referred to as
<em></em>\(\hat{p}\) and the prediction of the model with the removed
individual as <em></em>\(\hat{p}_{-i}\). The unweighted jackknife
estimator is defined as:</p>
<p>\[\hat{Var}(\hat{p})=\frac{n-1}{n}\sum_{i=1}^n(\hat{p}-\hat{p}_{-i}
)^2.\]</p>
<p>This is used by the <a href="ipcwmodel.html">predict()</a> function, when
<code>naive</code> argument is set to <code>TRUE</code>. When using IPCW weights the influence
of a individual depends on the weights and therefore the weights need to
be accounted for in the estimation. Instead of weighting each <em></em>\(
\hat{p}_{-i}\) prediction with <em></em>\(\frac{n-1}{n}\),
each model prediction with a non-zero weight gets weighted with
<em></em>\(1-\tilde{w}_i\). Here we assume the weights to
already sum to one. This is used by default, with <code>naive</code> being set
to <code>FALSE</code>.</p>
</div>

<div class="section">
<h3 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a></h3>


<p>IPCW weighting and weighted jackknife standard error estimation are
implemented in models inheriting from <a href="ipcwmodel.html">ipcwmodel</a>.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Blanche PF, Holt A, Scheike T (2023).
“On logistic regression with right censored data, with or without competing risks, and its use for estimating treatment effects.”
<em>Lifetime Data Analysis</em>, <b>29</b>(2), 441–482.
ISSN 1380-7870, <a href="https://doi.org/10.1007/s10985-022-09564-6" class="external-link">doi:10.1007/s10985-022-09564-6</a>
.<br><br> Efron B, Hastie T (2016).
<em>Computer age statistical inference: Algorithms, evidence, and data science</em>.
Cambridge University Press.<br><br> Holst KK, Scheike TH, Hjelmborg JB (2016).
“The Liability Threshold Model for Censored Twin Data.”
<em>Computational Statistics and Data Analysis</em>, <b>93</b>, 324-335.
<a href="https://doi.org/10.1016/j.csda.2015.01.014" class="external-link">doi:10.1016/j.csda.2015.01.014</a>
.<br><br> Kvamme H, Borgan Ø (2023).
“The Brier Score under Administrative Censoring: Problems and Solutions.”
<em>Journal of Machine Learning Research</em>, <b>24</b>, 1–26.
1912.08581.<br><br> Perme MP, Manevski D (2019).
“Confidence intervals for the Mann–Whitney test.”
<em>Statistical Methods in Medical Research</em>, <b>28</b>(12), 3755–3768.
ISSN 14770334, <a href="https://doi.org/10.1177/0962280218814556%2C" class="external-link">doi:10.1177/0962280218814556,</a>
, <a href="http://www.ncbi.nlm.nih.gov/pubmed/30514179" class="external-link">http://www.ncbi.nlm.nih.gov/pubmed/30514179</a>.<br><br> Reps JM, Rijnbeek P, Cuthbert A, Ryan PB, Pratt N, Schuemie M (2021).
“An empirical analysis of dealing with patients who are lost to follow-up when developing prognostic models using a cohort design.”
<em>BMC medical informatics and decision making</em>, <b>21</b>(1), 43.
ISSN 1472-6947, <a href="https://doi.org/10.1186/s12911-021-01408-x" class="external-link">doi:10.1186/s12911-021-01408-x</a>
, <a href="http://www.ncbi.nlm.nih.gov/pubmed/33549087" class="external-link">http://www.ncbi.nlm.nih.gov/pubmed/33549087</a>.<br><br> Scheike TH, Holst KK, B.Hjelmborg J (2014).
“Estimating heritability for cause specific mortality based on twin studies.”
<em>Lifetime Data Analysis</em>, <b>20</b>(2), 210-233.
<a href="https://doi.org/10.1007/s10985-013-9244-x" class="external-link">doi:10.1007/s10985-013-9244-x</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Useful links:</p><ul><li><p><a href="https://iden-project-uas-darmstadt.github.io/IPCWJK">https://iden-project-uas-darmstadt.github.io/IPCWJK</a></p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><strong>Maintainer</strong>: Lukas Klein <a href="mailto:lukas.klein@h-da.de">lukas.klein@h-da.de</a></p>
<p>Authors:</p><ul><li><p>Antje Jahn-Eimermacher</p></li>
</ul></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Antje Jahn-Eimermacher, Lukas Klein.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

