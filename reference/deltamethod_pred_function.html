<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply the delta method based on a prediction formula — deltamethod_pred_function • IPCWJK</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply the delta method based on a prediction formula — deltamethod_pred_function"><meta name="description" content="

Constructs a prediction function that computes model predictions and
their standard errors and Wald confidence interval using the delta method
for a user-specified prediction formula."><meta property="og:description" content="

Constructs a prediction function that computes model predictions and
their standard errors and Wald confidence interval using the delta method
for a user-specified prediction formula."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IPCWJK</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ipcw_models.html">IPCW Models for Survival Analysis</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/IDEN-Project-UAS-Darmstadt/IPCWJK" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Apply the delta method based on a prediction formula</h1>
      <small class="dont-index">Source: <a href="https://github.com/IDEN-Project-UAS-Darmstadt/IPCWJK/blob/HEAD/R/deltamethod_pred_function.R" class="external-link"><code>R/deltamethod_pred_function.R</code></a></small>
      <div class="d-none name"><code>deltamethod_pred_function.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>

Constructs a prediction function that computes model predictions and
their standard errors and Wald confidence interval using the delta method
for a user-specified prediction formula.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">deltamethod_pred_function</span><span class="op">(</span></span>
<span>  <span class="va">prediction_str</span>,</span>
<span>  <span class="va">coefs</span>,</span>
<span>  <span class="va">coef_cov</span>,</span>
<span>  additional_coefs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  fixed_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-prediction-str">prediction_str<a class="anchor" aria-label="anchor" href="#arg-prediction-str"></a></dt>
<dd><p>Character. A string specifying the prediction formula,
which must contain one occurrence of <code>"LP"</code> to be replaced by
the linear predictor constructed from the coefficients and covariate
values.</p></dd>


<dt id="arg-coefs">coefs<a class="anchor" aria-label="anchor" href="#arg-coefs"></a></dt>
<dd><p>Named numeric vector. The estimated coefficients from the fitted
model. The names must correspond to the covariate names used in the model.</p></dd>


<dt id="arg-coef-cov">coef_cov<a class="anchor" aria-label="anchor" href="#arg-coef-cov"></a></dt>
<dd><p>Square numeric matrix. The covariance matrix of the estimated
coefficients. The row and column names must match the names of
<code>coefs</code>.</p></dd>


<dt id="arg-additional-coefs">additional_coefs<a class="anchor" aria-label="anchor" href="#arg-additional-coefs"></a></dt>
<dd><p>Character vector. Names of coefficients in
<code>coefs</code> that are not part of the linear predictor but are required in
the prediction formula (default is an empty character vector).</p></dd>


<dt id="arg-fixed-vars">fixed_vars<a class="anchor" aria-label="anchor" href="#arg-fixed-vars"></a></dt>
<dd><p>List. Named list of fixed values for variables used in the
prediction formula but not present in the new data (default is an empty
list).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A function that takes a data frame of covariates and returns a
data frame with columns for the prediction, lower and upper Wald
confidence intervals, and standard error. The function can also take
an optional argument <code>z</code> for the z-score used in confidence
interval calculation (default is 1.96 for 95% CI).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is intended for use with fitted
regression models, including those for survival analysis, and allows
flexible specification of the linear predictor, additional coefficients,
and fixed covariate values. The resulting function can be applied to
new data to obtain both predictions and delta method-based standard
errors.</p>
<p>This function is used internally in the package to provide
delta method-based standard errors for as a comparison.</p>
<p>For a prediction function
<em></em>\(g(\theta)\), the standard error is approximated as
\[\sqrt{\nabla g(\theta)^\top \Sigma \nabla g(\theta)}\]
where <em></em>\(\Sigma\) is the covariance matrix of the estimated
coefficients.</p>
<p>The input <code>prediction_str</code> must contain one occurrence of
<code>"LP"</code>, which will be replaced by the linear predictor constructed
from the provided coefficients and covariate values.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>There are no references for Rd macro <code>\insertAllCites</code> on this help page.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other helpers:
<code><a href="deltamethod_from_model.html">deltamethod_from_model</a>()</code>,
<code><a href="ipcw_weights.html">ipcw_weights</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(Intercept)"</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">"age"</span> <span class="op">=</span> <span class="fl">0.1</span>, <span class="st">"sex"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coef_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.0025</span>, <span class="fl">0.0025</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">coef_cov</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">coef_cov</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coefs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_fun</span> <span class="op">&lt;-</span> <span class="fu">deltamethod_pred_function</span><span class="op">(</span></span></span>
<span class="r-in"><span>  prediction_str <span class="op">=</span> <span class="st">"1 / (1 + exp(-(LP)))"</span>,</span></span>
<span class="r-in"><span>  coefs <span class="op">=</span> <span class="va">coefs</span>,</span></span>
<span class="r-in"><span>  coef_cov <span class="op">=</span> <span class="va">coef_cov</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">60</span><span class="op">)</span>, sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pred_fun</span><span class="op">(</span><span class="va">newdata</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   prediction     lower    upper          se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.9950332 0.9707925 1.019274 0.012367680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.9984988 0.9896802 1.007317 0.004499284</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Antje Jahn-Eimermacher, Lukas Klein.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

